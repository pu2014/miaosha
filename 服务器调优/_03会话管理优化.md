## 优化会话管理
>开始我使用的是基于cookieid ： java tomcat 容器session实现
>code
```
//验证手机号和对应的optcode相符合
        String inSessionOptCode = (String)httpServletRequest.getSession().getAttribute(telephone);
            // 用druid的比较防止都为null
        if(!StringUtils.equals(optCode, inSessionOptCode)){
            throw new BusinessException(EmBusinessError.PARAMETER_VALIDATION_ERROR,"短信验证码不符合");
        }
        
//存储登录信息
//加入到用户登录成功的session类
        //假设单点session登录
        this.httpServletRequest.getSession().setAttribute("IS_LOGIN", true);
        this.httpServletRequest.getSession().setAttribute("LOGIN_USER", userModel);
//获取用户的登录信息
        Boolean isLogin = (Boolean) httpServletRequest.getSession().getAttribute("IS_LOGIN");
        if(isLogin == null || !isLogin.booleanValue()){
            throw new BusinessException(EmBusinessError.USER_NOT_LOGIN, "用户登录信息异常");
        }
        UserModel loginUser = (UserModel) httpServletRequest.getSession().getAttribute("LOGIN_USER");
```

问题
>在许多移动端在用户层面会把cookie屏蔽掉 可以使用token
>在分布式部署时，基于基于cookieid的会话是在tomcat的内存上的，当多台server上会造成会话丢失，
>session没有维护在集中管理的地方，而是在各自的服务器上


### 分布式会话管理
>使用redis缓存集中管理对应session


